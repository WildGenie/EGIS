<?xml version="1.0" encoding="utf-8"?>

<nlog internalLogFile="internalLog.txt" internalLogLevel="Error" throwExceptions="true" autoReload="true"
      xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <variable name="logDirectory" value="${basedir}/logs/${shortdate}" />
  <variable name="TWCFFilename" value="${logDirectory}/TWCF-E-BusClient1.log" />
  <variable name="logFileName" value="${logDirectory}/E-BusClient1.log" />
  <variable name="detailLogFileName" value="${logDirectory}/E-BusClient1(Detail).log" />

  <!-- See http://nlog-project.org/wiki/Configuration_file for information on customizing logging rules and outputs. -->

  <targets async="true">
    <!-- <target xsi:type="File" name="f" fileName="${basedir}/logs/${shortdate}.log" layout="${longdate} ${uppercase:${level}} ${message}" />  -->

    <target xsi:type="File"
            name="TWCFEbusClient"
            fileName="${TWCFFilename}"
            layout="${date:universalTime=true:format=u} | ${level} | ${machinename} | ${aspnet-user-identity} | ${message} | ${stacktrace:format=Flat:topFrames=4:separator=|}"
            concurrentWrites="true"
            archiveFileName="${logDirectory}/${level}{#####}.log"
            archiveAboveSize="10240"
            archiveNumbering="Sequence">
    </target>

    <target xsi:type="File"
            name="fileTarget-Simple"
            fileName="${logFileName}"
            layout="${level} ${longdate} ${message}"
            concurrentWrites="true"
            archiveFileName="${logDirectory}/${level}{#####}.log"
            archiveAboveSize="10240"
            archiveNumbering="Sequence">
    </target>

    <target xsi:type="File"
            name="fileTarget-Detail"
            fileName="${detailLogFileName}"
            layout="${level} ${longdate} ${machinename} ${message}"
            concurrentWrites="true"
            archiveFileName="${logDirectory}/${level}{#####}.log"
            archiveAboveSize="10240"
            archiveNumbering="Sequence">
    </target>

    <target xsi:type="File"
            name="fileTarget-FatalDetail"
            fileName="${logFileName}"
            layout="${level} ${longdate} ${message} ${event-context:item=requestType} ${event-context:item=requestUrl} ${event-context:item=requestQuerystring} ${event-context:item=requestStatus} ${event-context:item=message}"
            concurrentWrites="true"
            archiveFileName="${logDirectory}/${level}{#####}.log"
            archiveAboveSize="10240"
            archiveNumbering="Sequence">
    </target>

  </targets>

  <rules>
    <!--<logger name="GeoDecisions.Esb.Client.Console.ClientLogger" minlevel="Trace" writeTo="TWCFEBusClient" />-->
    <logger name="GeoDecisions.Esb.Client.Console.ClientLogger" minlevel="Trace" writeTo="fileTarget-Simple" />
    <!--<logger name="GeoDecisions.Esb.Client.Console.ClientLogger" minlevel="Error" writeTo="fileTarget-Detail" />-->
    <!--<logger name="*" minlevel="Fatal" writeTo="fileTarget-FatalDetail" />-->
  </rules>
</nlog>